<ion-header [translucent]="true">
  <ion-toolbar style="--background: #FFB6C1;">
    <div style="display: flex; justify-content: space-between; align-items: center;">
      <ion-title style="color: #696767; font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif; font-weight: 600;">
        Perfil
      </ion-title>
      <ion-buttons slot="end">
        <ion-button 
          style="--background: #FFB6C1; border-radius: 50%; width: 40px; height: 40px; display: flex; align-items: center; justify-content: center;" 
          routerLink="/home/viajes">
          <ion-icon name="arrow-forward-outline" style="color: white;"></ion-icon>
        </ion-button>
      </ion-buttons>
    </div>
  </ion-toolbar>
</ion-header>

<ion-content [fullscreen]="true" style="background-color: #f9f9f9;">
  <ion-card style="background-color: #ffffff;">
    <div style="text-align: center;">
      <img src="assets/img/perfil.png" 
           alt="Imagen de perfil del usuario" 
           style="width: 80px; height: 90px; border-radius: 50%; margin-bottom: 10px; object-fit: cover;">
    </div>
    
    <ion-card-header>
      <ion-card-title style="text-align: center; color: #696767;">
        <span style="font-size: 24px;">{{ persona.categoria }}</span>,
        <span style="color: #f062d3; font-size: 24px;" (click)="toggleEdit()" style="cursor: pointer;">
          <ng-container *ngIf="!isEditing; else editInput">{{ persona.nombre }}</ng-container>
          <ng-template #editInput>
            <ion-input 
              [(ngModel)]="persona.nombre" 
              (blur)="isEditing = false" 
              (keyup.enter)="isEditing = false" 
              style="width: 150px; 
                     background-color: #f5f5f5; 
                     border-radius: 8px; 
                     padding: 10px; 
                     text-align: center; 
                     --border-color: #FFB6C1; 
                     --highlight-color: #FFB6C1; 
                     --color: #696767;">
            </ion-input>
          </ng-template>
        </span>!
      </ion-card-title>
    </ion-card-header>
    
    <ion-card-content>
      <div class="qr-container">
        <qrcode
        [qrdata]="persona.rut + ' | ' + persona.nombre + ' | ' +  persona.email  + ' | ' + persona.categoria"
        [allowEmptyString]="true"
        [cssClass]="'center'"
        [colorDark]="'#000000ff'"
        [colorLight]="'#ffffffff'"
        [elementType]="'svg'"
        [errorCorrectionLevel]="'M'"
        [margin]="4"
        [scale]="1"
        [title]="'A custom title attribute'"
        [width]="180">
      </qrcode>
      </div>
      <div style="text-align: center;">
        <ion-input 
          [(ngModel)]="biografia" 
          placeholder="Escribe tu biografía aquí..." 
          (keyup.enter)="saveBio()" 
          [readonly]="!isEditing"
          style="flex-grow: 1; margin-bottom: 10px; 
                 background-color: #f5f5f5; 
                 border-radius: 8px; 
                 padding: 10px; 
                 text-align: center; 
                 --border-color: #FFB6C1; 
                 --highlight-color: #FFB6C1; 
                 --color: #696767;">
        </ion-input>
      </div>
    </ion-card-content>
  </ion-card>

  <div style="padding: 16px;">
    <form (ngSubmit)="addComment()">
      <ion-item>
        <ion-label position="floating">Comparte tu Experiencia</ion-label>
        <ion-input [(ngModel)]="nuevoComentario" name="comentario" required></ion-input>
      </ion-item>
      <ion-button expand="full" type="submit">Enviar</ion-button>
    </form>
   
    <ion-list style="margin-top: 16px;">
      <ion-item *ngFor="let comentario of comentarios">
        <ion-label><strong>{{ comentario.usuario }}:</strong> {{ comentario.texto }}</ion-label>
      </ion-item>
    </ion-list>
  </div>

  <ion-list>
    <ion-item routerLink="/mis-viajes" detail="true">
      <ion-icon name="car-sport-outline" slot="start" style="color: #FFB6C1;"></ion-icon>
      <span style="font-size: 1rem; color: #696767;">Mis Viajes</span>
    </ion-item>
    <ion-item routerLink="/contacto" detail="true">
      <ion-icon name="mail-outline" slot="start" style="color: #FFB6C1;"></ion-icon>
      <span style="font-size: 1rem; color: #696767;">Contacto</span>
    </ion-item>
    <ion-item routerLink="/ayuda" detail="true">
      <ion-icon name="help-circle-outline" slot="start" style="color: #FFB6C1;"></ion-icon>
      <span style="font-size: 1rem; color: #696767;">Ayuda</span>
    </ion-item>
    <ion-item expand="block" routerLink="/login" style="color: #FFB600; margin-top: 20px;">
      <span style="font-size: 1rem; color: #FFB6C1;">Cerrar sesión</span>
    </ion-item>
  </ion-list>
</ion-content>




